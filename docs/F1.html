<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="coqdoc.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery-1.8.3.js"></script>
<script type="text/javascript" src="main.js"></script>
<script type="text/javascript" src="MyStyles.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-88023543-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<h1 class="libtitle">F1: Koindukcja i korekursja</h1>

<div class="code">
</div>

<div class="doc">

</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">FunctionalExtensionality</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Omega</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Setoid</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">FinFun</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">NArith</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Div2</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ZArith</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab390"></a><h1 class="section">Koindukcja (TODO)</h1>

<div class="paragraph"> </div>

<a name="lab391"></a><h2 class="section">Strumienie (TODO)</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">Stream</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> : <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>;<br/>
}.<br/>

<br/>
<span class="id" title="var">Arguments</span> <span class="id" title="var">hd</span> {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="var">Arguments</span> <span class="id" title="var">tl</span> {<span class="id" title="var">A</span>}.<br/>

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">bisim</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hds</span> : <span class="id" title="var">hd</span> <span class="id" title="var">s1</span> = <span class="id" title="var">hd</span> <span class="id" title="var">s2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tls</span> : <span class="id" title="var">bisim</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s1</span>) (<span class="id" title="var">tl</span> <span class="id" title="var">s2</span>);<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bisim_refl</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>), <span class="id" title="var">bisim</span> <span class="id" title="var">s</span> <span class="id" title="var">s</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bisim_sym</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bisim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">bisim</span> <span class="id" title="var">s2</span> <span class="id" title="var">s1</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> 1 <span class="id" title="keyword">as</span> [<span class="id" title="var">hds</span> <span class="id" title="var">tls</span>]. <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bisim_trans</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s1</span> <span class="id" title="var">s2</span> <span class="id" title="var">s3</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bisim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">bisim</span> <span class="id" title="var">s2</span> <span class="id" title="var">s3</span> -&gt; <span class="id" title="var">bisim</span> <span class="id" title="var">s1</span> <span class="id" title="var">s3</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> 1 <span class="id" title="keyword">as</span> [<span class="id" title="var">hds1</span> <span class="id" title="var">tls1</span>], 1 <span class="id" title="keyword">as</span> [<span class="id" title="var">hds2</span> <span class="id" title="var">tls2</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">hds1</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab392"></a><h3 class="section">Jakieś pierdoły</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">from'</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">nat</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">from'</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>);<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">facts'</span> (<span class="id" title="var">r</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">nat</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">r</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">facts'</span> (<span class="id" title="var">r</span> * <span class="id" title="var">S</span> <span class="id" title="var">n</span>) (<span class="id" title="var">S</span> <span class="id" title="var">n</span>);<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">facts</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">nat</span> := <span class="id" title="var">facts'</span> 1 0.<br/>

<br/>
<span class="comment">(*Compute&nbsp;stake&nbsp;9&nbsp;facts.*)</span><br/>

<br/>
</div>

<div class="doc">
<a name="lab393"></a><h3 class="section">Z manuala Agdy</h3>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

    hd (evens s) := hd s;
    tl (evens s) := evens (tl (tl s));

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">evens</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">hd</span> <span class="id" title="var">s</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">evens</span> (<span class="id" title="var">tl</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>));<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">odds</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">hd</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">odds</span> (<span class="id" title="var">tl</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>));<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="tactic">split</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> * <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">evens</span> <span class="id" title="var">s</span>, <span class="id" title="var">odds</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">merge</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">ss</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> * <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">hd</span> (<span class="id" title="var">fst</span> <span class="id" title="var">ss</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">merge</span> (<span class="id" title="var">snd</span> <span class="id" title="var">ss</span>, <span class="id" title="var">tl</span> (<span class="id" title="var">fst</span> <span class="id" title="var">ss</span>));<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">merge_split</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bisim</span> (<span class="id" title="var">merge</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">s</span>)) <span class="id" title="var">s</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab394"></a><h3 class="section">Bijekcja między strumieniami i funkcjami</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Equiv_bisim</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="var">Equivalence</span> (@<span class="id" title="var">bisim</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">bisim_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">bisim_sym</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">bisim_trans</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">theChosenOne</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">tt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">theChosenOne</span>;<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">all_chosen_unit_aux</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span>, <span class="id" title="var">bisim</span> <span class="id" title="var">s</span> <span class="id" title="var">theChosenOne</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">hd</span> <span class="id" title="var">s</span>). <span class="id" title="var">cbn</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">all_chosen_unit</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span>, <span class="id" title="var">bisim</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">all_chosen_unit_aux</span> <span class="id" title="var">x</span>), (<span class="id" title="var">all_chosen_unit_aux</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">bisim_eq</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>), <span class="id" title="var">bisim</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">x</span> = <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">all_eq</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span>, <span class="id" title="var">x</span> = <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">bisim_eq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">all_chosen_unit</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unit_to_stream</span> (<span class="id" title="var">u</span> : <span class="id" title="var">unit</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span> := <span class="id" title="var">theChosenOne</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stream_to_unit</span> (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">unit</span>) : <span class="id" title="var">unit</span> := <span class="id" title="var">tt</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">unit_is_Stream_unit</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">Bijective</span> <span class="id" title="var">unit_to_stream</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">stream_to_unit</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">all_eq</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab395"></a><h3 class="section">Trochę losowości</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">rand</span> (<span class="id" title="var">seed</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <span class="id" title="var">Z</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">Z</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">Zmod</span> <span class="id" title="var">seed</span> <span class="id" title="var">n2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">rand</span> (<span class="id" title="var">Zmod</span> <span class="id" title="var">seed</span> <span class="id" title="var">n2</span> * <span class="id" title="var">n1</span>) <span class="id" title="var">n1</span> <span class="id" title="var">n2</span>;<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">rand'</span> (<span class="id" title="var">seed</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <span class="id" title="var">Z</span>) : <span class="id" title="var">Stream</span> <span class="id" title="var">Z</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd</span> := <span class="id" title="var">Zmod</span> <span class="id" title="var">seed</span> <span class="id" title="var">n2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl</span> := <span class="id" title="var">rand</span> (<span class="id" title="var">Zmod</span> (<span class="id" title="var">seed</span> * <span class="id" title="var">n1</span>) <span class="id" title="var">n2</span>) <span class="id" title="var">n1</span> <span class="id" title="var">n2</span>;<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">stake</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">Stream</span> <span class="id" title="var">A</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">hd</span> <span class="id" title="var">s</span> :: <span class="id" title="var">stake</span> <span class="id" title="var">n'</span> (<span class="id" title="var">tl</span> <span class="id" title="var">s</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">stake</span> 10 (<span class="id" title="var">rand</span> 1 123456789 987654321).<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">stake</span> 10 (<span class="id" title="var">rand'</span> 1235 234567890 6652).<br/>

<br/>
</div>

<div class="doc">
<a name="lab396"></a><h2 class="section">Kolisty</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">Conat</span> : <span class="id" title="keyword">Type</span> :=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pred</span> : <span class="id" title="var">option</span> <span class="id" title="var">Conat</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">coList</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uncons</span> : <span class="id" title="var">option</span> (<span class="id" title="var">A</span> * <span class="id" title="var">coList</span> <span class="id" title="var">A</span>);<br/>
}.<br/>

<br/>
<span class="id" title="var">Arguments</span> <span class="id" title="var">uncons</span> {<span class="id" title="var">A</span>}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">tocoList</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) : <span class="id" title="var">coList</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uncons</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> :: <span class="id" title="var">t</span> =&gt; <span class="id" title="var">Some</span> (<span class="id" title="var">h</span>, <span class="id" title="var">tocoList</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">tocoList_inj</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Set</span>} (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tocoList</span> <span class="id" title="var">l1</span> = <span class="id" title="var">tocoList</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">l1</span> = <span class="id" title="var">l2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l1</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">h1</span> <span class="id" title="var">t1</span>]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">h2</span> <span class="id" title="var">t2</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt1</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">from</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">coList</span> <span class="id" title="var">nat</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uncons</span> := <span class="id" title="var">Some</span> (<span class="id" title="var">n</span>, <span class="id" title="var">from</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>));<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lhead</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>) : <span class="id" title="var">option</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">uncons</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">a</span>, <span class="id" title="var">_</span>) =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">None</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ltail</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>) : <span class="id" title="var">option</span> (<span class="id" title="var">coList</span> <span class="id" title="var">A</span>) :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">uncons</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">_</span>, <span class="id" title="var">t</span>) =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">None</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">lnth</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>) : <span class="id" title="var">option</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span>, <span class="id" title="var">uncons</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">None</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0, <span class="id" title="var">Some</span> (<span class="id" title="var">x</span>, <span class="id" title="var">_</span>) =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span>, <span class="id" title="var">Some</span> (<span class="id" title="var">_</span>, <span class="id" title="var">l'</span>) =&gt; <span class="id" title="var">lnth</span> <span class="id" title="var">n'</span> <span class="id" title="var">l'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lnth</span> 511 (<span class="id" title="var">from</span> 0).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nats</span> := <span class="id" title="var">from</span> 0.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="tactic">repeat</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">coList</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uncons</span> := <span class="id" title="var">Some</span> (<span class="id" title="var">x</span>, <span class="id" title="tactic">repeat</span> <span class="id" title="var">x</span>);<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Eval</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lnth</span> 123 (<span class="id" title="tactic">repeat</span> 5).<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">lapp</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>) : <span class="id" title="var">coList</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">uncons</span> <span class="id" title="var">l1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">h</span>, <span class="id" title="var">t</span>) =&gt; {| <span class="id" title="var">uncons</span> := <span class="id" title="var">Some</span> (<span class="id" title="var">h</span>, <span class="id" title="var">lapp</span> <span class="id" title="var">t</span> <span class="id" title="var">l2</span>) |}<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*<br/>
CoFixpoint&nbsp;general_omega&nbsp;{A&nbsp;:&nbsp;Set}&nbsp;(l1&nbsp;l2&nbsp;:&nbsp;coList&nbsp;A)&nbsp;:&nbsp;coList&nbsp;A&nbsp;:=<br/>
match&nbsp;l1,&nbsp;l2&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_,&nbsp;LNil&nbsp;=&gt;&nbsp;l1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;LNil,&nbsp;LCons&nbsp;h'&nbsp;t'&nbsp;=&gt;&nbsp;LCons&nbsp;h'&nbsp;(general_omega&nbsp;t'&nbsp;l2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;LCons&nbsp;h&nbsp;t,&nbsp;_&nbsp;=&gt;&nbsp;LCons&nbsp;h&nbsp;(general_omega&nbsp;t&nbsp;l2)<br/>
end.<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">lmap</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>) : <span class="id" title="var">coList</span> <span class="id" title="var">B</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uncons</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">uncons</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">h</span>, <span class="id" title="var">t</span>) =&gt; <span class="id" title="var">Some</span> (<span class="id" title="var">f</span> <span class="id" title="var">h</span>, <span class="id" title="var">lmap</span> <span class="id" title="var">f</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Finite</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} : <span class="id" title="var">coList</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Finite_nil</span> : <span class="id" title="var">Finite</span> {| <span class="id" title="var">uncons</span> := <span class="id" title="var">None</span> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Finite_cons</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">h</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Finite</span> <span class="id" title="var">t</span> -&gt; <span class="id" title="var">Finite</span> {| <span class="id" title="var">uncons</span> := <span class="id" title="var">Some</span> (<span class="id" title="var">h</span>, <span class="id" title="var">t</span>) |}.<br/>

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">Infinite</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">h</span> : <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">p</span> : <span class="id" title="var">uncons</span> <span class="id" title="var">l</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">h</span>, <span class="id" title="var">t</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inf'</span> : <span class="id" title="var">Infinite</span> <span class="id" title="var">t</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">empty_not_Infinite</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>, ~ <span class="id" title="var">Infinite</span> {| <span class="id" title="var">uncons</span> := @<span class="id" title="var">None</span> (<span class="id" title="var">A</span> * <span class="id" title="var">coList</span> <span class="id" title="var">A</span>) |}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> []. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lmap_Infinite</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Infinite</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">Infinite</span> (<span class="id" title="var">lmap</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> 1. <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lapp_Infinite_l</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Infinite</span> <span class="id" title="var">l1</span> -&gt; <span class="id" title="var">Infinite</span> (<span class="id" title="var">lapp</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> 1. <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l1</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lapp_Infinite_r</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Infinite</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">Infinite</span> (<span class="id" title="var">lapp</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l1</span> <span class="id" title="keyword">as</span> [[[<span class="id" title="var">h</span> <span class="id" title="var">t</span>] |]]; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">lazy</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Finite_not_Infinite</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Finite</span> <span class="id" title="var">l</span> -&gt; ~ <span class="id" title="var">Infinite</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1; <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHFinite</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*<br/>
Lemma&nbsp;Infinite_not_Finite&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(l&nbsp;:&nbsp;coList&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Infinite&nbsp;l&nbsp;-&gt;&nbsp;~&nbsp;Finite&nbsp;l.<br/>
Proof.<br/>
&nbsp;&nbsp;induction&nbsp;2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;inversion&nbsp;H.&nbsp;inversion&nbsp;p.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;IHFinite.&nbsp;inversion&nbsp;H;&nbsp;inversion&nbsp;p;&nbsp;subst.&nbsp;assumption.<br/>
Qed.<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">bisim2</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bisim2'</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uncons</span> <span class="id" title="var">l1</span> = <span class="id" title="var">None</span> /\ <span class="id" title="var">uncons</span> <span class="id" title="var">l2</span> = <span class="id" title="var">None</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">h1</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">t1</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>) (<span class="id" title="var">h2</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">t2</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uncons</span> <span class="id" title="var">l1</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">h1</span>, <span class="id" title="var">t1</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uncons</span> <span class="id" title="var">l2</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">h2</span>, <span class="id" title="var">t2</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">h1</span> = <span class="id" title="var">h2</span> /\ <span class="id" title="var">bisim2</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Hint Constructors</span> <span class="id" title="var">bisim2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bisim2_refl</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>), <span class="id" title="var">bisim2</span> <span class="id" title="var">l</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [[[<span class="id" title="var">h</span> <span class="id" title="var">t</span>]|]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">h</span>, <span class="id" title="var">t</span>, <span class="id" title="var">h</span>, <span class="id" title="var">t</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bisim2_symm</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bisim2</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">bisim2</span> <span class="id" title="var">l2</span> <span class="id" title="var">l1</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> 1 <span class="id" title="keyword">as</span> [[[] | (<span class="id" title="var">h1</span> &amp; <span class="id" title="var">t1</span> &amp; <span class="id" title="var">h2</span> &amp; <span class="id" title="var">t2</span> &amp; <span class="id" title="var">p1</span> &amp; <span class="id" title="var">p2</span> &amp; <span class="id" title="var">p3</span> &amp; <span class="id" title="var">H</span>)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">h2</span>, <span class="id" title="var">t2</span>, <span class="id" title="var">h1</span>, <span class="id" title="var">t1</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bisim2_trans</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">l3</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bisim2</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">bisim2</span> <span class="id" title="var">l2</span> <span class="id" title="var">l3</span> -&gt; <span class="id" title="var">bisim2</span> <span class="id" title="var">l1</span> <span class="id" title="var">l3</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> 1 <span class="id" title="keyword">as</span> [[[] | (<span class="id" title="var">h11</span> &amp; <span class="id" title="var">t11</span> &amp; <span class="id" title="var">h12</span> &amp; <span class="id" title="var">t12</span> &amp; <span class="id" title="var">p11</span> &amp; <span class="id" title="var">p12</span> &amp; <span class="id" title="var">p13</span> &amp; <span class="id" title="var">H1</span>)]],<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 <span class="id" title="keyword">as</span> [[[] | (<span class="id" title="var">h21</span> &amp; <span class="id" title="var">t21</span> &amp; <span class="id" title="var">h22</span> &amp; <span class="id" title="var">t22</span> &amp; <span class="id" title="var">p21</span> &amp; <span class="id" title="var">p22</span> &amp; <span class="id" title="var">p23</span> &amp; <span class="id" title="var">H2</span>)]];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p21</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">p21</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p12</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">p12</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p12</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p21</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">p21</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">h22</span>, <span class="id" title="var">t11</span>, <span class="id" title="var">h22</span>, <span class="id" title="var">t22</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">CH</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lmap_compose</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bisim2</span> (<span class="id" title="var">lmap</span> <span class="id" title="var">g</span> (<span class="id" title="var">lmap</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>)) (<span class="id" title="var">lmap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [[[<span class="id" title="var">h</span> <span class="id" title="var">t</span>]|]]; [<span class="id" title="tactic">right</span> | <span class="id" title="tactic">left</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">h</span>)), (<span class="id" title="var">lmap</span> <span class="id" title="var">g</span> (<span class="id" title="var">lmap</span> <span class="id" title="var">f</span> <span class="id" title="var">t</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">h</span>)), (<span class="id" title="var">lmap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">reflexivity</span> | <span class="id" title="tactic">idtac</span>]). <span class="id" title="tactic">apply</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bisim2_Infinite</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bisim2</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">Infinite</span> <span class="id" title="var">l1</span> -&gt; <span class="id" title="var">Infinite</span> <span class="id" title="var">l2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> 1 <span class="id" title="keyword">as</span> [[[] | (<span class="id" title="var">h1</span> &amp; <span class="id" title="var">t1</span> &amp; <span class="id" title="var">h2</span> &amp; <span class="id" title="var">t2</span> &amp; <span class="id" title="var">p1</span> &amp; <span class="id" title="var">p2</span> &amp; <span class="id" title="var">p3</span> &amp; <span class="id" title="var">H</span>)]], 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">p2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">CH</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab397"></a><h2 class="section">Drzewka</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">coBTree</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> : <span class="id" title="var">option</span> (<span class="id" title="var">coBTree</span> <span class="id" title="var">A</span> * <span class="id" title="var">A</span> * <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>)<br/>
}.<br/>

<br/>
<span class="id" title="var">Arguments</span> <span class="id" title="var">root</span> {<span class="id" title="var">A</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">fmap</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">coBTree</span> <span class="id" title="var">B</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">root</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">l</span>, <span class="id" title="var">v</span>, <span class="id" title="var">r</span>) =&gt; <span class="id" title="var">Some</span> (<span class="id" title="var">fmap</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>, <span class="id" title="var">f</span> <span class="id" title="var">v</span>, <span class="id" title="var">fmap</span> <span class="id" title="var">f</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
|}.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">ns</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">coBTree</span> <span class="id" title="var">nat</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> := <span class="id" title="var">Some</span> (<span class="id" title="var">ns</span> (1 + 2 * <span class="id" title="var">n</span>), <span class="id" title="var">n</span>, <span class="id" title="var">ns</span> (2 + 2 * <span class="id" title="var">n</span>))<br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">BTree</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span> : <span class="id" title="var">BTree</span> <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">BTree</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">BTree</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">BTree</span> <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="var">Arguments</span> <span class="id" title="var">Empty</span> {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="var">Arguments</span> <span class="id" title="var">Node</span> {<span class="id" title="var">A</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">ttake</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">BTree</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">Empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">root</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">Empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">l</span>, <span class="id" title="var">v</span>, <span class="id" title="var">r</span>) =&gt; <span class="id" title="var">Node</span> <span class="id" title="var">v</span> (<span class="id" title="var">ttake</span> <span class="id" title="var">n'</span> <span class="id" title="var">l</span>) (<span class="id" title="var">ttake</span> <span class="id" title="var">n'</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">ttake</span> 5 (<span class="id" title="var">ns</span> 0).<br/>

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">tsim</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tsim'</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> <span class="id" title="var">t1</span> = <span class="id" title="var">None</span> /\ <span class="id" title="var">root</span> <span class="id" title="var">t2</span> = <span class="id" title="var">None</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">v1</span> <span class="id" title="var">v2</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> <span class="id" title="var">t1</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">l1</span>, <span class="id" title="var">v1</span>, <span class="id" title="var">r1</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> <span class="id" title="var">t2</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">l2</span>, <span class="id" title="var">v2</span>, <span class="id" title="var">r2</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tsim</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> /\ <span class="id" title="var">tsim</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span><br/>
}.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">mirror</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">t</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>) : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">root</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">root</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">l</span>, <span class="id" title="var">v</span>, <span class="id" title="var">r</span>) =&gt; <span class="id" title="var">Some</span> (<span class="id" title="var">mirror</span> <span class="id" title="var">r</span>, <span class="id" title="var">v</span>, <span class="id" title="var">mirror</span> <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">tsim_mirror_inv</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">coBTree</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tsim</span> (<span class="id" title="var">mirror</span> (<span class="id" title="var">mirror</span> <span class="id" title="var">t</span>)) <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">cofix</span> <span class="id" title="var">CH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [[[[<span class="id" title="var">l</span> <span class="id" title="var">v</span>] <span class="id" title="var">r</span>]|]]; <span class="id" title="tactic">constructor</span>; [<span class="id" title="tactic">right</span> | <span class="id" title="tactic">left</span>]. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">v</span>, <span class="id" title="var">v</span>, (<span class="id" title="var">mirror</span> (<span class="id" title="var">mirror</span> <span class="id" title="var">l</span>)), <span class="id" title="var">l</span>, (<span class="id" title="var">mirror</span> (<span class="id" title="var">mirror</span> <span class="id" title="var">r</span>)), <span class="id" title="var">r</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab398"></a><h2 class="section">Rekursja ogólna</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">Div</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">call</span> : <span class="id" title="var">A</span> + <span class="id" title="var">Div</span> <span class="id" title="var">A</span><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">even</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">bool</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> (<span class="id" title="var">S</span> <span class="id" title="var">n'</span>) =&gt; <span class="id" title="var">even</span> <span class="id" title="var">n'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;name&nbsp;is&nbsp;very&nbsp;unfortunate.&nbsp;*)</span><br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">collatz</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">Div</span> <span class="id" title="var">unit</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">call</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 | 1 =&gt; <span class="id" title="var">inl</span> <span class="id" title="var">tt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">n'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">even</span> <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="var">inr</span> (<span class="id" title="var">collatz</span> (<span class="id" title="var">div2</span> <span class="id" title="var">n'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">inr</span> (<span class="id" title="var">collatz</span> (1 + 3 * <span class="id" title="var">n'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
|}.<br/>

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="var">Div</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">fuel</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">d</span> : <span class="id" title="var">Div</span> <span class="id" title="var">A</span>) : <span class="id" title="var">option</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span>, <span class="id" title="var">d</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">Build_Div</span> <span class="id" title="var">_</span> (<span class="id" title="var">inl</span> <span class="id" title="var">a</span>) =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span>, <span class="id" title="var">Build_Div</span> <span class="id" title="var">_</span> (<span class="id" title="var">inr</span> <span class="id" title="var">d'</span>) =&gt; <span class="id" title="var">fuel</span> <span class="id" title="var">n'</span> <span class="id" title="var">d'</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">fuel</span> 5 (<span class="id" title="var">collatz</span> 4).<br/>

<br/>
<span class="id" title="var">Arguments</span> <span class="id" title="var">uncons</span> {<span class="id" title="var">A</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">collatz'</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">coList</span> <span class="id" title="var">nat</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 =&gt; {| <span class="id" title="var">uncons</span> := <span class="id" title="var">None</span> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; {| <span class="id" title="var">uncons</span> := <span class="id" title="var">Some</span> (1, {| <span class="id" title="var">uncons</span> := <span class="id" title="var">None</span> |}) |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">n'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">even</span> <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> {| <span class="id" title="var">uncons</span> := <span class="id" title="var">Some</span> (<span class="id" title="var">n'</span>, <span class="id" title="var">collatz'</span> (<span class="id" title="var">div2</span> <span class="id" title="var">n'</span>)) |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> {| <span class="id" title="var">uncons</span> := <span class="id" title="var">Some</span> (<span class="id" title="var">n'</span>, <span class="id" title="var">collatz'</span> (1 + 3 * <span class="id" title="var">n'</span>)) |}<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">take</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">coList</span> <span class="id" title="var">A</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> :=<br/>
<span class="id" title="keyword">match</span> <span class="id" title="var">n</span>, <span class="id" title="var">uncons</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0, <span class="id" title="var">_</span> =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">None</span> =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span>, <span class="id" title="var">Some</span> (<span class="id" title="var">h</span>, <span class="id" title="var">t</span>) =&gt; <span class="id" title="var">h</span> :: <span class="id" title="var">take</span> <span class="id" title="var">n'</span> <span class="id" title="var">t</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt; <span class="id" title="var">take</span> 200 (<span class="id" title="var">collatz'</span> <span class="id" title="var">n</span>)) [30; 31; 32; 33].<br/>
<span class="id" title="keyword">Compute</span> <span class="id" title="var">take</span> 150 (<span class="id" title="var">collatz'</span> 12344).<br/>

<br/>
</div>

<div class="doc">
insertion sort na kolistach 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoFixpoint</span> <span class="id" title="var">ins</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">coList</span> <span class="id" title="var">nat</span>) : <span class="id" title="var">coList</span> <span class="id" title="var">nat</span> :=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uncons</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">uncons</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> (<span class="id" title="var">h</span>, <span class="id" title="var">t</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">n</span> &lt;=? <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Some</span> (<span class="id" title="var">n</span>, {| <span class="id" title="var">uncons</span> := <span class="id" title="var">Some</span> (<span class="id" title="var">h</span>, <span class="id" title="var">t</span>) |})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Some</span> (<span class="id" title="var">h</span>, <span class="id" title="var">ins</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
|}.<br/>

<br/>
<span class="comment">(*<br/>
CoFixpoint&nbsp;ss&nbsp;(s&nbsp;:&nbsp;coList&nbsp;nat)&nbsp;:&nbsp;coList&nbsp;nat&nbsp;:=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;uncons&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;uncons&nbsp;s&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;=&gt;&nbsp;None<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;(h,&nbsp;t)&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;uncons&nbsp;(ss&nbsp;t)&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None&nbsp;=&gt;&nbsp;None<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;(h',&nbsp;t')&nbsp;=&gt;&nbsp;Some&nbsp;(h',&nbsp;ins&nbsp;h&nbsp;t')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br/>
|}.<br/>
*)</span><br/>

<br/>
</div>

<div class="doc">
Relacja dobrze ufundowana nie ma nieskończonych łańcuchów malejących 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">CoInductive</span> <span class="id" title="var">DecChain</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">hd'</span> : <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R_hd'_x</span> : <span class="id" title="var">R</span> <span class="id" title="var">hd'</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tl'</span> : <span class="id" title="var">DecChain</span> <span class="id" title="var">R</span> <span class="id" title="var">hd'</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wf_no_DecChain</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">well_founded</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">DecChain</span> <span class="id" title="var">R</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">False</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">well_founded</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">H</span> <span class="id" title="var">C</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">C</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">C</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">with</span> <span class="id" title="var">hd'</span>; <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
wut - końcówka kolistowego burdla 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>

<br/>
<span class="comment">(*<br/>
CoInductive&nbsp;Rev&nbsp;{A&nbsp;:&nbsp;Type}&nbsp;(l&nbsp;r&nbsp;:&nbsp;coList&nbsp;A)&nbsp;:&nbsp;Prop&nbsp;:=<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Rev'&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(uncons&nbsp;l&nbsp;=&nbsp;None&nbsp;/\&nbsp;uncons&nbsp;r&nbsp;=&nbsp;None)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exists&nbsp;(h&nbsp;:&nbsp;A)&nbsp;(tl&nbsp;tr&nbsp;:&nbsp;coList&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uncons&nbsp;l&nbsp;=&nbsp;Some&nbsp;(h,&nbsp;tl)&nbsp;/\&nbsp;r&nbsp;=&nbsp;snoc&nbsp;tr&nbsp;h&nbsp;/\&nbsp;Rev&nbsp;tl&nbsp;tr<br/>
}.<br/>
<br/>
Lemma&nbsp;Rev_wut&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(l&nbsp;r&nbsp;:&nbsp;coList&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Infinite&nbsp;l&nbsp;-&gt;&nbsp;Infinite&nbsp;r&nbsp;-&gt;&nbsp;Rev&nbsp;l&nbsp;r.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;cofix&nbsp;CH.<br/>
&nbsp;&nbsp;constructor.&nbsp;right.&nbsp;destruct&nbsp;H,&nbsp;H0.<br/>
&nbsp;&nbsp;exists&nbsp;h,&nbsp;t,&nbsp;r.&nbsp;split.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;assumption.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;split.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Focus&nbsp;2.&nbsp;apply&nbsp;CH;&nbsp;auto;&nbsp;econstructor;&nbsp;eauto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;eq_lsim.&nbsp;apply&nbsp;lsim_symm.&nbsp;apply&nbsp;Infinite_snoc.&nbsp;econstructor;&nbsp;eauto.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Rev_Finite&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(l&nbsp;r&nbsp;:&nbsp;coList&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Rev&nbsp;l&nbsp;r&nbsp;-&gt;&nbsp;Finite&nbsp;r&nbsp;-&gt;&nbsp;Finite&nbsp;l.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;intros&nbsp;A&nbsp;l&nbsp;r&nbsp;HRev&nbsp;H.&nbsp;revert&nbsp;l&nbsp;HRev.<br/>
&nbsp;&nbsp;induction&nbsp;H&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">r</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">r'</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">IH</span></span>;&nbsp;intros.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;HRev&nbsp;as&nbsp;<span class="inlinecode">[[<span class="id" title="var">H1</span></span> <span class="inlinecode"><span class="id" title="var">H2</span>]</span> <span class="inlinecode">|</span> <span class="inlinecode">(<span class="id" title="var">h</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">tl</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">tr</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H1</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H2</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H3</span>)]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left.&nbsp;assumption.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subst.&nbsp;cbn&nbsp;in&nbsp;H.&nbsp;destruct&nbsp;(uncons&nbsp;tr)&nbsp;as&nbsp;<span class="inlinecode">[]|</span>;&nbsp;inv&nbsp;H.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;HRev&nbsp;as&nbsp;<span class="inlinecode">[[<span class="id" title="var">H1</span></span> <span class="inlinecode"><span class="id" title="var">H2</span>]</span> <span class="inlinecode">|</span> <span class="inlinecode">(<span class="id" title="var">h'</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">tl</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">tr</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H1</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H2</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H3</span>)]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;congruence.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subst.<br/>
Abort.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Rev_Finite&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(l&nbsp;r&nbsp;:&nbsp;coList&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Rev&nbsp;l&nbsp;r&nbsp;-&gt;&nbsp;Finite&nbsp;l&nbsp;-&gt;&nbsp;Finite&nbsp;r.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;intros&nbsp;A&nbsp;l&nbsp;r&nbsp;HRev&nbsp;H.&nbsp;revert&nbsp;r&nbsp;HRev.<br/>
&nbsp;&nbsp;induction&nbsp;H;&nbsp;intros.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;HRev&nbsp;as&nbsp;<span class="inlinecode">[[<span class="id" title="var">H1</span></span> <span class="inlinecode"><span class="id" title="var">H2</span>]</span> <span class="inlinecode">|</span> <span class="inlinecode">(<span class="id" title="var">h</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">tl</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">tr</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H1</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H2</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H3</span>)]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left.&nbsp;assumption.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subst.&nbsp;congruence.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;HRev&nbsp;as&nbsp;<span class="inlinecode">[[<span class="id" title="var">H1</span></span> <span class="inlinecode"><span class="id" title="var">H2</span>]</span> <span class="inlinecode">|</span> <span class="inlinecode">(<span class="id" title="var">h'</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">tl</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">tr</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H1</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H2</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">H3</span>)]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;congruence.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subst.&nbsp;rewrite&nbsp;H1&nbsp;in&nbsp;H.&nbsp;inv&nbsp;H.&nbsp;apply&nbsp;Finite_snoc,&nbsp;IHFinite.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assumption.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Infinite_Rev&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(l&nbsp;r&nbsp;:&nbsp;coList&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Rev&nbsp;l&nbsp;r&nbsp;-&gt;&nbsp;Infinite&nbsp;l&nbsp;-&gt;&nbsp;Infinite&nbsp;r.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;cofix&nbsp;CH.<br/>
&nbsp;&nbsp;destruct&nbsp;1.&nbsp;<span class="comment">(*&nbsp;decompose&nbsp;<span class="inlinecode"><span class="id" title="var">ex</span></span> <span class="inlinecode"><span class="id" title="var">or</span></span> <span class="inlinecode"><span class="id" title="var">and</span></span>&nbsp;Revc0;&nbsp;clear&nbsp;Revc0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;destruct&nbsp;1.&nbsp;congruence.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intro.&nbsp;subst.&nbsp;destruct&nbsp;x1&nbsp;as&nbsp;<span class="inlinecode">[[<span class="id" title="var">h</span></span> <span class="inlinecode"><span class="id" title="var">t</span>]</span> <span class="inlinecode">|]</span>;&nbsp;cbn.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;econstructor.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cbn.&nbsp;reflexivity.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;(CH&nbsp;_&nbsp;(cocons&nbsp;x&nbsp;t)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constructor.&nbsp;cbn.&nbsp;right.&nbsp;exists&nbsp;x,&nbsp;t,&nbsp;t.&nbsp;auto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;congruence.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subst.&nbsp;cbn&nbsp;in&nbsp;*.&nbsp;inversion&nbsp;p;&nbsp;subst.&nbsp;*)</span><br/>
Abort.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Lemma&nbsp;Finite_cocons&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(x&nbsp;:&nbsp;A)&nbsp;(l&nbsp;:&nbsp;coList&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Finite&nbsp;l&nbsp;-&gt;&nbsp;Finite&nbsp;(cocons&nbsp;x&nbsp;l).<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;intros.&nbsp;apply&nbsp;(Finite_Some&nbsp;x&nbsp;l);&nbsp;auto.<br/>
Qed.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>
<br/>
Fixpoint&nbsp;fromList&nbsp;{A&nbsp;:&nbsp;Type}&nbsp;(l&nbsp;:&nbsp;list&nbsp;A)&nbsp;:&nbsp;coList&nbsp;A&nbsp;:=<br/>
{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;uncons&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;l&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"></span>&nbsp;=&gt;&nbsp;None<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;h&nbsp;::&nbsp;t&nbsp;=&gt;&nbsp;Some&nbsp;(h,&nbsp;fromList&nbsp;t)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;end<br/>
|}.<br/>
<br/>
Lemma&nbsp;fromList_inj&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;forall&nbsp;{A&nbsp;:&nbsp;Set}&nbsp;(l1&nbsp;l2&nbsp;:&nbsp;list&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;fromList&nbsp;l1&nbsp;=&nbsp;fromList&nbsp;l2&nbsp;-&gt;&nbsp;l1&nbsp;=&nbsp;l2.<br/>
<span class="comment">(*&nbsp;begin&nbsp;hide&nbsp;*)</span><br/>
Proof.<br/>
&nbsp;&nbsp;induction&nbsp;l1&nbsp;as&nbsp;<span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">h1</span></span> <span class="inlinecode"><span class="id" title="var">t1</span></span>;&nbsp;destruct&nbsp;l2&nbsp;as&nbsp;<span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">h2</span></span> <span class="inlinecode"><span class="id" title="var">t2</span></span>;&nbsp;cbn;&nbsp;inversion&nbsp;1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;reflexivity.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;f_equal.&nbsp;apply&nbsp;IHt1.&nbsp;assumption.<br/>
Defined.<br/>
*)</span><br/>

<br/>
</div>

<div class="doc">
<a name="lab399"></a><h1 class="section">Ćwiczenia</h1>

<div class="paragraph"> </div>

<a name="lab400"></a><h4 class="section">Ćwiczenie</h4>

<div class="paragraph"> </div>

 Zdefiniuj typ potencjalnie nieskończonych drzew binarnych trzymających
    wartości typu <span class="inlinecode"><span class="id" title="var">A</span></span> w węzłach, jego relację bipodobieństwa, predykaty
    "skończony" i "nieskończony" oraz funkcję <span class="inlinecode"><span class="id" title="var">mirror</span></span>, która zwraca
    lustrzane odbicie drzewa. Udowodnij, że bipodobieństwo jest relacją
    równoważności i że funkcja <span class="inlinecode"><span class="id" title="var">mirror</span></span> jest inwolucją (tzn.
    <span class="inlinecode"><span class="id" title="var">mirror</span></span> <span class="inlinecode">(<span class="id" title="var">mirror</span></span> <span class="inlinecode"><span class="id" title="var">t</span>)</span> jest bipodobne do <span class="inlinecode"><span class="id" title="var">t</span></span>), która zachowuje właściwości
    bycia drzewem skończonym/nieskończonym. Pokaż, że drzewo nie może być
    jednocześnie skończone i nieskończone. 
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a name="lab401"></a><h4 class="section">Ćwiczenie</h4>

<div class="paragraph"> </div>

 Znajdź taką rodzinę typów koinduktywnych <span class="inlinecode"><span class="id" title="var">C</span></span>, że dla dowolnego
    typu <span class="inlinecode"><span class="id" title="var">A</span></span>, <span class="inlinecode"><span class="id" title="var">C</span></span> <span class="inlinecode"><span class="id" title="var">A</span></span> jest w bijekcji z typem funkcji <span class="inlinecode"><span class="id" title="var">nat</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">A</span></span>. Przez
    bijekcję będziemy tu rozumieć funkcję, która ma odwrotność, z którą
    w obie strony składa się do identyczności.

<div class="paragraph"> </div>

    Uwaga: nie da się tego udowodnić bez użycia dodatkowych aksjomatów,
    które na szczęście są bardzo oczywiste i same się narzucają. 
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a name="lab402"></a><h4 class="section">Ćwiczenie</h4>

<div class="paragraph"> </div>

 Zdefiniuj pojęcie "nieskończonego łańcucha malejącego" (oczywiście
    za pomocą koindukcji) i udowodnij, że jeżeli relacja jest dobrze
    ufundowana, to nie ma nieskończonych łańcuchów malejących. 
</div>
<div class="code">

<br/>
</div>
